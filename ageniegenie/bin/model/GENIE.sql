SELECT * FROM USER_TABLES;

CREATE TABLE GENIE(
   GNUM INT PRIMARY KEY,
   TITLE VARCHAR(200) NOT NULL,
   ARTIST VARCHAR(200) NOT NULL,
   ALBUM VARCHAR(200) NOT NULL,
   VIEWNUM INT NOT NULL
);

CREATE TABLE MEMBER(
   MNUM INT PRIMARY KEY,
   MID VARCHAR(200) NOT NULL,
   MPW VARCHAR(200) NOT NULL,
   MNAME VARCHAR(200) NOT NULL
);

CREATE TABLE MYPAGE( 
   MYNUM INT PRIMARY KEY,
	GNUM INT NOT NULL,
   MEMBERNUM INT NOT NULL
);
   

SELECT * FROM USER_TABLES;
DROP TABLE GENIE;
DROP TABLE MEMBER;
DROP TABLE MYPAGE;
SELECT GNUM, VIEWNUM, ROWNUM, TITLE FROM GENIE;
SELECT * FROM GENIE;
SELECT * FROM MEMBER;
SELECT * FROM MYPAGE;

INSERT INTO MYPAGE VALUES((SELECT NVL(MAX(MYNUM),0)+1 FROM MYPAGE), 40, 1111)
INSERT INTO MEMBER VALUES((SELECT NVL(MAX(MNUM),0)+1 FROM MEMBER), '1111', '1111', '관리자');

SELECT GNUM, TITLE, RANK() OVER (ORDER BY VIEWNUM DESC), ROWNUM FROM GENIE;

SELECT * FROM (SELECT RANK() OVER (ORDER BY VIEWNUM DESC) AS "조회수순서", TITLE, ROWNUM FROM GENIE WHERE (ROWNUM BETWEEN 1 AND 5) AND (GNUM NOT IN(SELECT GNUM FROM MYPAGE GNUM))ORDER BY DBMS_RANDOM.RANDOM) WHERE ROWNUM <=1; 
SELECT * FROM (SELECT GNUM,VIEWNUM, TITLE, ROWNUM FROM (SELECT * FROM GENIE ORDER BY VIEWNUM DESC) WHERE(ROWNUM BETWEEN 1 AND 5) AND (GNUM NOT IN(SELECT GNUM FROM MYPAGE GNUM))ORDER BY DBMS_RANDOM.RANDOM) WHERE ROWNUM <=1; 

SELECT * FROM (SELECT lol.*,ROWNUM AS RNUM FROM (SELECT * FROM GENIE ORDER BY VIEWNUM DESC) lol WHERE ROWNUM<=10) WHERE RNUM>=1;

SELECT * FROM (SELECT GNUM,VIEWNUM, TITLE, ROWNUM FROM (SELECT * FROM GENIE ORDER BY VIEWNUM DESC) WHERE(ROWNUM BETWEEN 1 AND 5) AND (GNUM NOT IN(SELECT GNUM FROM MYPAGE))ORDER BY DBMS_RANDOM.RANDOM) WHERE ROWNUM <=1; 

SELECT A.* FROM (SELECT RANK() OVER (ORDER BY VIEWNUM DESC) ,VIEWNUM, TITLE, ARTIST, ROWNUM FROM (SELECT * FROM GENIE WHERE GNUM NOT IN(SELECT GNUM FROM MYPAGE) ORDER BY VIEWNUM desc )  WHERE (ROWNUM BETWEEN 1 AND 5)  ORDER BY DBMS_RANDOM.RANDOM)A WHERE ROWNUM<=5;

SELECT A.* FROM (SELECT RANK() OVER (ORDER BY VIEWNUM DESC), TITLE, ARTIST, VIEWNUM FROM (SELECT * FROM GENIE WHERE GNUM NOT IN(SELECT GNUM FROM MYPAGE))  WHERE (ROWNUM BETWEEN 1 AND 5)  ORDER BY DBMS_RANDOM.RANDOM)A WHERE ROWNUM>=1